<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ïà´Í∏Ä Î≥ÄÌôòÍ∏∞ ( Soowim Ï†úÏûë )</title>

    <link rel="shortcut icon" href="icon.ico" type="image/x-icon">
    <link rel="icon" href="icon.ico" type="image/x-icon">

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 600px;
            margin-top: 20px;
            position: relative;
            padding-bottom: 60px;
        }

        h1 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 2rem;
            text-align: center;
            letter-spacing: -0.5px;
            color: #ffffff;
        }

        .section {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 8px;
            color: #888;
            text-transform: uppercase;
        }

        textarea {
            width: 100%;
            height: 140px;
            padding: 14px;
            border: 1px solid #333;
            border-radius: 12px;
            font-size: 16px;
            background-color: #1e1e1e;
            color: #ffffff;
            transition: border-color 0.2s;
            resize: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        textarea:focus {
            outline: none;
            border-color: #555;
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 20px 0;
        }

        button {
            padding: 16px;
            border: none;
            border-radius: 12px;
            background-color: #ffffff;
            color: #000000;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        button.secondary {
            background-color: #333;
            color: #ffffff;
        }

        button:active {
            opacity: 0.8;
        }

        .result-container {
            margin-top: 2rem;
            border-top: 1px solid #222;
            padding-top: 1.5rem;
            position: relative;
        }

        #result {
            min-height: 80px;
            white-space: pre-wrap;
            word-break: break-all;
            font-size: 1.15rem;
            font-weight: 500;
            color: #ffffff;
            padding: 10px 0;
            padding-right: 60px;
            letter-spacing: 0.5px;
        }

        .copy-btn {
            position: absolute;
            top: 1.5rem;
            right: 0;
            padding: 8px 12px;
            font-size: 0.75rem;
            background-color: #444;
            color: #fff;
            border-radius: 6px;
            border: none;
            cursor: pointer;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            font-size: 0.8rem;
            color: #555;
            letter-spacing: 1px;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>üîê // Ïà´Í∏Ä Î≥ÄÌôòÍ∏∞</h1>

        <div class="section">
            <label>Input</label>
            <textarea id="input" placeholder="ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
        </div>

        <div class="btn-group">
            <button onclick="toNum()">ÌïúÍ∏Ä ‚Üí Ïà´Í∏Ä</button>
            <button class="secondary" onclick="toKor()">Ïà´Í∏Ä ‚Üí ÌïúÍ∏Ä</button>
        </div>

        <div class="result-container">
            <label>Result</label>
            <button class="copy-btn" onclick="copyResult()">Copy</button>
            <div id="result"></div>
        </div>

        <footer>Soowim Ï†úÏûë</footer>
    </div>

    <script>
        const initialMap = { '„Ñ±': '1', '„Ñ≤': '011', '„Ñ¥': '2', '„Ñ∑': '3', '„Ñ∏': '033', '„Ñπ': '4', '„ÖÅ': '5', '„ÖÇ': '6', '„ÖÉ': '066', '„ÖÖ': '7', '„ÖÜ': '077', '„Öá': '8', '„Öà': '9', '„Öâ': '099', '„Öä': '10', '„Öã': '11', '„Öå': '12', '„Öç': '13', '„Öé': '14' };
        const vowelMap = { '„Öè': ['01'], '„Öê': ['102'], '„Öë': ['02'], '„Öí': ['103'], '„Öì': ['03'], '„Öî': ['104'], '„Öï': ['04'], '„Öñ': ['105'], '„Öó': ['05'], '„Öò': ['05', '01'], '„Öô': ['05', '102'], '„Öö': ['05', '101'], '„Öõ': ['06'], '„Öú': ['07'], '„Öù': ['07', '03'], '„Öû': ['07', '104'], '„Öü': ['07', '101'], '„Ö†': ['08'], '„Ö°': ['09'], '„Ö¢': ['09', '101'], '„Ö£': ['101'] };
        const finalMap = ['', '1', '011', '17', '2', '29', '214', '3', '4', '41', '45', '46', '47', '412', '413', '414', '5', '6', '67', '7', '077', '8', '9', '10', '11', '12', '13', '14'];
        const CHOSUNG = ['„Ñ±', '„Ñ≤', '„Ñ¥', '„Ñ∑', '„Ñ∏', '„Ñπ', '„ÖÅ', '„ÖÇ', '„ÖÉ', '„ÖÖ', '„ÖÜ', '„Öá', '„Öà', '„Öâ', '„Öä', '„Öã', '„Öå', '„Öç', '„Öé'];
        const JUNGSUNG = ['„Öè', '„Öê', '„Öë', '„Öí', '„Öì', '„Öî', '„Öï', '„Öñ', '„Öó', '„Öò', '„Öô', '„Öö', '„Öõ', '„Öú', '„Öù', '„Öû', '„Öü', '„Ö†', '„Ö°', '„Ö¢', '„Ö£'];

        function toNum() {
            const text = document.getElementById('input').value;
            let tokens = [];
            let i = 0;
            while (i < text.length) {
                let char = text[i];
                let code = char.charCodeAt(0);
                if (code >= 0xAC00 && code <= 0xD7A3) {
                    let n = code - 0xAC00;
                    let jong = n % 28;
                    let jung = ((n - jong) / 28) % 21;
                    let cho = Math.floor(((n - jong) / 28) / 21);
                    let parts = [initialMap[CHOSUNG[cho]], ...vowelMap[JUNGSUNG[jung]]];
                    if (jong > 0) parts.push(finalMap[jong]);
                    tokens.push({ type: 'hangul', value: parts.join(',') });
                } else if (/[0-9]/.test(char)) {
                    let numStr = "";
                    while (i < text.length && /[0-9]/.test(text[i])) { numStr += text[i]; i++; }
                    tokens.push({ type: 'number', value: '0' + numStr + '0' });
                    continue;
                } else { tokens.push({ type: 'other', value: char }); }
                i++;
            }
            let output = "";
            for (let j = 0; j < tokens.length; j++) {
                output += tokens[j].value;
                if (j < tokens.length - 1) {
                    let curr = tokens[j], next = tokens[j + 1];
                    if (curr.type === 'hangul' && next.type === 'hangul') output += ".";
                    else if (curr.type === 'number' && next.type === 'hangul') output += ",";
                    else if (curr.type === 'hangul' && next.type === 'number') output += ",";
                }
            }
            document.getElementById('result').innerText = output;
        }

        function toKor() {
            let input = document.getElementById('input').value;
            input = input.replace(/0([0-9]+)0/g, '$1');
            const revInitial = Object.fromEntries(Object.entries(initialMap).map(([k, v]) => [v, CHOSUNG.indexOf(k)]));
            const revVowel = Object.fromEntries(Object.entries(vowelMap).map(([k, v]) => [v.join(','), JUNGSUNG.indexOf(k)]));
            const revFinal = Object.fromEntries(finalMap.map((v, i) => [v, i]));

            let finalStr = "";
            let blocks = input.split(/([ \n])/);

            blocks.forEach(block => {
                if (block === " " || block === "\n") { finalStr += block; return; }

                let syllables = block.split('.');
                syllables.forEach(syllable => {
                    let parts = syllable.split(',');
                    let pIdx = 0;
                    while (pIdx < parts.length) {
                        let choIdx = revInitial[parts[pIdx]];
                        if (choIdx === undefined) { finalStr += parts[pIdx]; pIdx++; continue; }

                        let jungIdx = undefined;
                        let vStep = 0;

                        // Ï§ëÏÑ± Ï∞æÍ∏∞ Ïö∞ÏÑ†ÏàúÏúÑ: 2Í∞ú Ï°∞Ìï©(„Öò Îì±) -> 1Í∞ú
                        if (pIdx + 2 < parts.length) {
                            let v2 = parts[pIdx + 1] + ',' + parts[pIdx + 2];
                            if (revVowel[v2] !== undefined) { jungIdx = revVowel[v2]; vStep = 2; }
                        }
                        if (jungIdx === undefined && pIdx + 1 < parts.length) {
                            let v1 = parts[pIdx + 1];
                            if (revVowel[v1] !== undefined) { jungIdx = revVowel[v1]; vStep = 1; }
                        }

                        if (jungIdx === undefined) { finalStr += parts[pIdx]; pIdx++; continue; }

                        let jongIdx = 0;
                        // Ï¢ÖÏÑ± ÌåêÎã®: ÌòÑÏû¨ ÏùåÏ†à(parts)Ïùò ÎÅùÏù¥Í≥†, Ï¢ÖÏÑ± ÎßµÏóê Ï°¥Ïû¨Ìï† ÎïåÎßå Ï¢ÖÏÑ±ÏúºÎ°ú Ïù∏Ï†ï
                        if (pIdx + vStep + 1 < parts.length) {
                            let possibleJong = parts[pIdx + vStep + 1];
                            if (revFinal[possibleJong] !== undefined) {
                                jongIdx = revFinal[possibleJong];
                                pIdx += (vStep + 2);
                            } else { pIdx += (vStep + 1); }
                        } else { pIdx += (vStep + 1); }

                        finalStr += String.fromCharCode(0xAC00 + (choIdx * 588) + (jungIdx * 28) + jongIdx);
                    }
                });
            });
            document.getElementById('result').innerText = finalStr;
        }

        function copyResult() {
            const resultText = document.getElementById('result').innerText;
            if (!resultText) return;
            navigator.clipboard.writeText(resultText).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.innerText = "Done";
                setTimeout(() => { btn.innerText = "Copy"; }, 1500);
            });
        }
    </script>
</body>

</html>
